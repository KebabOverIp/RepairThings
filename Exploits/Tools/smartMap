#!/bin/bash
#Homemade nmap scanner
#usage : smartMap <target>
labelTCP=date | cut -d " " -f 2,3,5 | sed -e 's/://g' | sed -e 's/ //g'
IP=$1
curPath=$(pwd)
echo "[+] SCANNING TARGET : $IP  [+]"
#Retrieve openports
ports=$(nmap -Pn -p- --min-rate=1000 -n -T4 $IP | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)
echo "[+] SCANNING TCP ports: $ports [+]"
labelTCP=$(date | cut -d " " -f 2,3,5 | sed -e 's/://g' | sed -e 's/ //g')
#scan openports
nmap -Pn -sC -sV --version-intensity 8 --osscan-limit -p$ports $IP -oN nmap-TCP-$IP-$labelTCP.txt --reason
echo "[+] SCANNING UDP TOP 20 [+]"
#udp scan
labelUDP=$(date | cut -d " " -f 2,3,5 | sed -e 's/://g' | sed -e 's/ //g')
nmap -sU --top-ports 20 $IP  -oN nmap-UDPTOP20-$IP-$labelUDP.txt
echo "[+] Logs files location : $curPath  [+]"
